@page "/dashboard"
@using BoilerPlate.Models
@using BoilerPlate.Services
@inject TicketService Tickets
@inject SessionService Session
@inject NavigationManager Nav

<div class="container py-5">
    <h3 class="text-center mb-4">Your Tickets</h3>

    @foreach(var t in Tickets.GetByUser(Session.CurrentUsername!))
    {
        <div class="card mb-2 p-3">
            <div><strong>Link:</strong> @t.LinkId</div>
            <div class="mt-1">@t.Content</div>
            <div class="mt-2">
                <span class="badge @(Badge(t.Status))">@t.Status</span>
            </div>
        </div>
    }

    <div class="text-center mt-4">
        <button class="btn btn-success btn-lg"
                @onclick='() => Nav.NavigateTo("/submit")'>
            Submit Another Ticket
        </button>
    </div>
</div>

@code {
    string Badge(TicketStatus s) =>
        s == TicketStatus.InProgress ? "bg-warning" :
        s == TicketStatus.Resolved   ? "bg-success" : "bg-secondary";
}